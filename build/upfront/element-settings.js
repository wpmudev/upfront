!function(t){define([],function(){var t=Upfront.Settings&&Upfront.Settings.l10n?Upfront.Settings.l10n.global.views:Upfront.mainData.l10n.global.views,e=Backbone.View.extend({id:"settings",events:{"click .upfront-save_settings":"saveSettings"},initialize:function(t){this.options=t,this.panels=_([])},saveSettings:function(){this.panels.each(function(t){t.save_settings()}),this.model.get("properties").trigger("change"),Upfront.Events.trigger("element:settings:saved"),Upfront.Events.trigger("element:settings:deactivate"),_upfront_post_data.layout.specificity&&_upfront_post_data.layout.item&&!_upfront_post_data.layout.item.match(/-page/)?Upfront.Events.trigger("command:layout:save_as"):Upfront.Events.trigger("command:layout:save")},get_title:function(){return t.settings},render:function(){var e=this;e.$el.html('<div class="upfront-settings_title">'+this.get_title()+"</div>"),Upfront.Events.trigger("settings:prepare"),e.panels.each(function(t){t.render(),e.listenTo(t,"upfront:settings:panel:toggle",e.toggle_panel),e.listenTo(t,"upfront:settings:panel:close",e.close_panel),e.listenTo(t,"upfront:settings:panel:refresh",e.refresh_panel),t.parent_view=e,e.$el.append(t.el)}),this.toggle_panel(this.panels.first());this.panels.first().$el.find(".upfront-settings_label").outerWidth(),this.panels.first().$el.find(".upfront-settings_panel").outerWidth();this.$el.addClass("upfront-ui"),this.$el.append("<div class='upfront-settings-button_panel'><button type='button' class='upfront-save_settings'><i class='icon-ok'></i> "+t.save+"</button></div>")},set_title:function(t){return!(!t||!t.length)&&void this.$el.find(".upfront-settings_title").html(t)},toggle_panel:function(t){this.panels.invoke("conceal"),t.$el.find(".upfront-settings_panel").css("height",""),t.show(),t.reveal(),this.set_title(t.get_title())},refresh_panel:function(t){t.is_active()&&this.toggle_panel(t)},close_panel:function(t){this.panels.invoke("conceal"),this.panels.invoke("show"),this.set_title(this.get_title())},cleanUp:function(){this.panels&&this.panels.each(function(t){t.cleanUp()}),this.remove()}});return e})}(jQuery);