!function(e){define(["text!elements/upfront-text/tpl/utext.html"],function(t){var n=Upfront.Models.ObjectModel.extend({init:function(){this.init_property("type","PlainTxtModel"),this.init_property("view_class","PlainTxtView"),this.init_property("element_id",Upfront.Util.get_unique_id("text-object")),this.init_property("class","c24 upfront-plain_txt"),this.init_property("has_settings",1),this.init_property("id_slug","plain_text")}}),o=Upfront.Views.ObjectView.extend({className:"upfront-plain_txt",cssSelectors:{".upfront-plain_txt":{label:"Text container",info:"The layer that contains all the text of the element."}},initialize:function(){this.constructor.__super__.initialize.apply(this,arguments),this.model instanceof n||(this.model=new n({properties:this.model.get("properties")})),this.on("deactivated",function(){Upfront.Events.trigger("upfront:element:edit:stop")},this)},get_content_markup:function(){var n=this.model.get_content();e(n).hasClass("plaintxt_padding")&&(n=e(n).html()),e(n).find("div.plaintxt_padding");var o={content:n,background_color:this.model.get_property_value_by_name("background_color"),border:this.model.get_property_value_by_name("border")},i="";return i=_.template(t,o)},is_edited:function(){var e=this.model.get_property_value_by_name("is_edited");return e?!0:!1},on_render:function(){var t=this;this.$el.find(".upfront-object-content").addClass("upfront-plain_txt").ueditor({linebreaks:!1,autostart:!1}).on("start",function(){var n=e(this).find(".upfront-quick-swap");n.length&&n.remove(),t.model.set_property("is_edited",!0,!0),Upfront.Events.trigger("upfront:element:edit:start","text")}).on("stop",function(){Upfront.Events.trigger("upfront:element:edit:stop")}).on("syncAfter",function(){t.model.set_content(e(this).html(),{silent:!0})})}}),i=Upfront.Views.Editor.Sidebar.Element.extend({priority:10,render:function(){this.$el.addClass("upfront-icon-element upfront-icon-element-text"),this.$el.html("Text")},add_element:function(){var e=new n({name:"",properties:[{name:"content",value:"<p>My awesome stub content goes here</p>"}]}),t=new Upfront.Models.Module({name:"",properties:[{name:"element_id",value:Upfront.Util.get_unique_id("module")},{name:"class",value:"c11"},{name:"row",value:Upfront.Util.height_to_row(75)},{name:"has_settings",value:0}],objects:[e]});this.add_module(t)}}),r=Upfront.Views.Editor.Settings.Panel.extend({className:"plaintxt-settings-panel",initialize:function(){var e,t=this;e=function(){this.settings.invoke("render")},_.bindAll(this,"onBgColor","onBorderColor"),this.settings=_([new Upfront.Views.Editor.Settings.Item({model:this.model,title:"Textbox Appearance",fields:[new Upfront.Views.Editor.Field.Radios({className:"inline-radios  plaintext-settings",model:this.model,property:"border_style",label:"Border",default_value:"solid",values:[{label:"None",value:"none"},{label:"Solid",value:"solid"},{label:"Dashed",value:"dashed"},{label:"Dotted",value:"dotted"}]}),new Upfront.Views.Editor.Field.Number({className:"inline-number plaintext-settings",model:this.model,min:1,property:"border_width",label:"Width",default_value:"1",values:[{label:"",value:"1"}]}),new Upfront.Views.Editor.Field.Color({className:"upfront-field-wrap upfront-field-wrap-color sp-cf  plaintext-settings inline-color border-color",model:this.model,property:"border_color",label:"Color",spectrum:{preferredFormat:"hex",change:this.onBorderColor,move:this.onBorderColor}}),new Upfront.Views.Editor.Field.Color({className:"upfront-field-wrap upfront-field-wrap-color sp-cf  plaintext-settings inline-color bg-color",model:this.model,property:"bg_color",label:"Background Color",spectrum:{preferredFormat:"hex",change:this.onBgColor,move:this.onBgColor}})]})]),this.$el.on("change","input[name=border_style]",function(e){t.onBorderStyle(e)}),this.$el.on("change","input[name=border_width]",function(e){t.onBorderWidth(e)})},onBgColor:function(e){this.property("bg_color",e.toRgbString(),!1),this.processBg()},onBorderWidth:function(t){this.property("border_width",e(t.currentTarget).val(),!1),this.processBorder()},onBorderColor:function(e){this.property("border_color",e.toRgbString(),!1),this.processBorder()},onBorderStyle:function(t){this.property("border_style",e(t.currentTarget).val(),!1),this.processBorder()},processBg:function(){"rgba(0, 0, 0, 0)"==this.property("bg_color")?this.property("background_color","",!1):this.property("background_color",this.property("bg_color"),!1)},processBorder:function(){"none"!=this.property("border_style")?(this.property("border",this.property("border_width")+"px "+this.property("border_color")+" "+this.property("border_style"),!1),this.$el.find("div.inline-color.plaintext-settings.border-color, div.inline-number.plaintext-settings").css("display","inline-block")):(this.property("border","",!1),this.$el.find("div.inline-color.plaintext-settings.border-color, div.inline-number.plaintext-settings").css("display","none"))},property:function(e,t,n){return"undefined"!=typeof t?("undefined"==typeof n&&(n=!0),this.model.set_property(e,t,n)):this.model.get_property_value_by_name(e)},get_label:function(){return"Appearance"},render:function(){this.constructor.__super__.render.apply(this,arguments);"none"!=this.property("border_style")?this.$el.find("div.inline-color.plaintext-settings.border-color, div.inline-number.plaintext-settings").css("display","inline-block"):this.$el.find("div.inline-color.plaintext-settings.border-color, div.inline-number.plaintext-settings").css("display","none"),this.$el.find(".upfront-settings_label").remove(),this.$el.find(".upfront-settings_panel").css("left",0)}}),l=Upfront.Views.Editor.Settings.Settings.extend({initialize:function(){this.panels=_([new r({model:this.model})])},get_title:function(){return"Textbox Appearance"}}),s=Upfront.Views.ContextMenuList.extend({initialize:function(){var t=this;this.menuitems=_([new Upfront.Views.ContextMenuItem({get_label:function(){return"Edit Text"},action:function(){var n=t.for_view.$el.find("div.upfront-object-content").data("ueditor");t.for_view.$el.find("div.upfront-object-content").data("redactor")||(n.start(),e(document).on("click",function(t){if(!n.options.autostart&&n.redactor){var o=e(t.target);n.disableStop||o.closest("li").length||o.closest(".redactor_air").length||o.closest(".ueditable").length||n.stop()}}))}})])}}),d=Upfront.Views.ContextMenu.extend({initialize:function(){this.menulists=_([new s])}});Upfront.Application.LayoutEditor.add_object("PlainTxt",{Model:n,View:o,Element:i,Settings:l,ContextMenu:d}),Upfront.Models.PlainTxtModel=n,Upfront.Views.PlainTxtView=o})}(jQuery);