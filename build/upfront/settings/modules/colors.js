define(["scripts/upfront/settings/modules/base-module"],function(e){var t=Upfront.Settings.l10n.preset_manager,o=e.extend({className:"settings_module colors_settings_item clearfix",group:!0,get_title:function(){return this.options.title},initialize:function(e){this.options=e||{},this.fieldCounter=0;var o=this,i=this.options.state,s="single",l="no-toggle",n=[];this.options.toggle===!0&&this.fieldCounter++,this.options.single!==!0&&(s="two"),_.each(this.options.abccolors,function(e){o.options.toggle===!0&&(l="element-toggled");var t=new Upfront.Views.Editor.Field.Color({className:i+"-color-field upfront-field-wrap-color color-module module-color-field "+l+" "+s,blank_alpha:0,model:o.model,name:e.name,default_value:o.model.get(e.name),label_style:"inline",label:e.label,spectrum:{preferredFormat:"hex",change:function(t){if(!t)return!1;var i=t.get_is_theme_color()!==!1?t.theme_color:t.toRgbString();o.model.set(e.name,i)},move:function(t){if(!t)return!1;var i=t.get_is_theme_color()!==!1?t.theme_color:t.toRgbString();o.model.set(e.name,i)}}});n.push(t)}),this.fields=_(n),this.options.toggle===!0&&(this.group=!1,this.fields.unshift(new Upfront.Views.Editor.Field.Checkboxes({model:this.model,className:"useColors checkbox-title",name:o.options.fields.use,label:"",multiple:!1,values:[{label:t.color,value:"yes",checked:this.model.get(o.options.fields.use)}],change:function(e){o.model.set(o.options.fields.use,e),o.reset_fields(e)},show:function(e,t){var o=t.closest(".state_modules");"yes"==e?o.find("."+i+"-color-field").show():o.find("."+i+"-color-field").hide()}})))},reset_fields:function(e){var t=this;"undefined"!=typeof e&&"yes"===e&&(_.each(this.options.abccolors,function(e){var o=t.get_static_field_value(e,t.options.prepend);t.update_field(e,o),t.save_static_value(e,o),this.fieldCounter++}),this.$el.empty(),this.render())},save_static_value:function(e,t){this.model.set(e.name,t.color)},get_static_field_value:function(e,t){var o={},i="";return"undefined"!=typeof this.options.prefix&&(i=this.options.prefix+"-"),o.color=this.model.get(this.clear_prepend(i+e.name,t))||"",o},clear_prepend:function(e,t){return e.replace(t,"")},update_field:function(e,t){this.fields._wrapped[this.fieldCounter].set_value(t.color),this.fields._wrapped[this.fieldCounter].update_input_border_color(t.color)},render:function(){var e=this;this.constructor.__super__.render.call(this),this.fields.each(function(t){if("undefined"!=typeof t.spectrumOptions){var o=e.model.get(t.name);t.set_value(o),t.update_input_border_color(Upfront.Util.colors.to_color_value(o))}})}});return o});