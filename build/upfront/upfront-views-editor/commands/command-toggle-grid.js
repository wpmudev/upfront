!function(t){var i=Upfront.Settings&&Upfront.Settings.l10n?Upfront.Settings.l10n.global.views:Upfront.mainData.l10n.global.views;define(["scripts/upfront/upfront-views-editor/commands/command","text!upfront/templates/overlay_grid.html"],function(n,o){return n.extend({className:"command-grid",initialize:function(){this.constructor.__super__.initialize.apply(this,arguments),this.listenTo(Upfront.Events,"entity:region:added",this.update_grid),this.listenTo(Upfront.Events,"upfront:layout_size:change_breakpoint",this.update_grid),this.listenTo(Upfront.Events,"grid:toggle",this.on_click)},render:function(){this.$el.addClass("upfront-icon upfront-icon-grid"),this.$el.prop("title",i.toggle_grid)},on_click:function(){t(".upfront-overlay-grid").size()||this.create_grid(),this.toggle_grid()},create_grid:function(){this.update_grid()},toggle_grid:function(){Upfront.Application.get_gridstate()?this.hide_grid():this.show_grid()},show_grid:function(){this.$el.addClass("upfront-icon-grid-active"),t(".upfront-overlay-grid").addClass("upfront-overlay-grid-show"),Upfront.Application.set_gridstate(!0)},hide_grid:function(){this.$el.removeClass("upfront-icon-grid-active"),t(".upfront-overlay-grid").removeClass("upfront-overlay-grid-show"),Upfront.Application.set_gridstate(!1)},update_grid:function(i){var n=(t(Upfront.Settings.LayoutEditor.Selectors.main),Upfront.Settings.LayoutEditor.Grid);t(".upfront-overlay-grid").remove(),t(".upfront-grid-layout, .upfront-region-side-fixed .upfront-modules_container, .upfront-region-side-lightbox .upfront-modules_container").each(function(){var i=n.size,r=_.template(o,{columns:i,size_class:n.class,style:"simple"});t(this).prepend(r),Upfront.Application.adjust_grid_padding_settings(this)}),Upfront.Application.get_gridstate()&&this.show_grid()}})})}(jQuery);