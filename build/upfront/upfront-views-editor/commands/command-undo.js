!function(n){var t=Upfront.Settings&&Upfront.Settings.l10n?Upfront.Settings.l10n.global.views:Upfront.mainData.l10n.global.views;define(["scripts/upfront/upfront-views-editor/commands/command"],function(e){return e.extend({className:"command-undo",initialize:function(){Upfront.Events.on("command:undo",this.render,this),Upfront.Events.on("command:redo",this.render,this),Upfront.Events.on("upfront:undo:state_stored",this.render,this),this.deactivate()},render:function(){this.$el.addClass("upfront-icon upfront-icon-undo"),this.$el.prop("title",t.undo),this.model.has_undo_states()?this.activate():this.deactivate()},activate:function(){this.$el.css("opacity",1)},deactivate:function(){this.$el.css("opacity",.5)},on_click:function(){var e=this,o=!1,i=new Upfront.Views.Editor.Loading({loading:t.undoing,done:t.undoing_done,fixed:!0});i.render(),n("body").append(i.$el),o=e.model.restore_undo_state(),o&&o.done?o.done(function(){Upfront.Events.trigger("command:undo"),e.render(),i.done()}):setTimeout(function(){i.done()},100)}})})}(jQuery);